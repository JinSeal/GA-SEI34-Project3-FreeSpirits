{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/jinz/Projects/project3/frontend/components/DonationForm.js\";\nvar __jsx = React.createElement;\nimport React, { Component } from \"react\";\nimport Router from \"next/router\";\nimport gql from \"graphql-tag\";\nimport { FormField, TextInputField, Autocomplete, TextInput, Checkbox, Button, Heading, Combobox } from \"evergreen-ui\";\nimport styled from \"styled-components\";\nimport StripeCheckout from \"react-stripe-checkout\";\nimport { Query, Mutation } from \"react-apollo\";\nimport _ from \"underscore\";\nconst Styles = styled.div.withConfig({\n  displayName: \"DonationForm__Styles\",\n  componentId: \"d9hi8b-0\"\n})([\"background-color:white;padding:2rem 5rem;\"]);\nconst ALL_CATS_QUERY = gql`\n  query ALL_CATS_QUERY {\n    allCats {\n      id\n      name\n      image\n      iucnStatus\n    }\n  }\n`;\nconst CREATE_DONATION_MUTATION = gql`\n  mutation CREATE_DONATION_MUTATION(\n    $amount: Integer!\n    $email: String!\n    $stripetoken: String!\n    $cat: String!\n  ) {\n    createDonation(\n      input: {\n        amount: $amount\n        email: $email\n        stripetoken: $stripetoken\n        cat: $cat\n      }\n    ) {\n      ok\n      donation {\n        id\n      }\n    }\n  }\n`;\n\nclass DonationForm extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      email: \"\",\n      updates: false,\n      gift: this.props.amount || 20,\n      allocation: \"\"\n    });\n\n    _defineProperty(this, \"saveToState\", e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"onToken\", async (res, createDonation) => {\n      const donation = await createDonation({\n        variables: {\n          amount: Number(this.state.gift),\n          stripetoken: res.id,\n          email: res.email,\n          cat: this.state.allocation\n        }\n      }).then(res => {\n        Router.push({\n          pathname: \"/thankyou\"\n        });\n      }).catch(err => {\n        alert(err.message);\n      });\n    });\n  }\n\n  render() {\n    return __jsx(Query, {\n      query: ALL_CATS_QUERY,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, ({\n      data\n    }) => {\n      const catsName = _.pluck(data.allCats, \"name\");\n\n      let cat = _.where(data.allCats, {\n        name: this.state.allocation\n      })[0];\n\n      let image = cat ? cat.image : \"/image/stripe.jpg\";\n      return __jsx(Styles, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, __jsx(FormField, {\n        label: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, __jsx(Heading, {\n        size: 500,\n        marginTop: \"default\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, \"Email\"), __jsx(TextInput, {\n        placeholder: \"Enter your email\",\n        width: 400,\n        value: this.state.email,\n        label: \"email\",\n        onChange: e => this.setState({\n          email: e.target.value\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }), __jsx(Heading, {\n        size: 500,\n        marginTop: \"default\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Gift Amount *\"), __jsx(Autocomplete, {\n        height: 50,\n        items: [25.0, 50.0, 100.0, 200.0, 500.0],\n        onChange: changedItem => this.setState({\n          gift: changedItem\n        }),\n        initialInputValue: this.state.gift.toString(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, props => {\n        const {\n          getInputProps,\n          getRef,\n          inputValue,\n          openMenu\n        } = props;\n        return __jsx(TextInput, _extends({\n          placeholder: \"Choose or Enter an Amount\",\n          width: 400,\n          value: inputValue,\n          innerRef: getRef,\n          label: \"Gift Amount\"\n        }, getInputProps({\n          onFocus: () => {\n            openMenu();\n          }\n        }), {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }));\n      }), __jsx(Heading, {\n        size: 500,\n        marginTop: \"default\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, \"Allocation\"), __jsx(Combobox, {\n        name: \"allocation\",\n        openOnFocus: true,\n        width: 400,\n        items: [...catsName, \"All Cats\"],\n        onChange: selected => this.setState({\n          allocation: selected\n        }),\n        placeholder: \"Select a Cat\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        style: {\n          display: \"flex\",\n          alignItems: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, __jsx(Checkbox, {\n        name: \"updates\",\n        checked: this.state.update,\n        onChange: e => this.setState({\n          update: e.target.checked\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }), __jsx(Heading, {\n        size: 500,\n        marginTop: 0,\n        marginLeft: 10,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"Keep me updated on Free Spirits news\")), __jsx(Mutation, {\n        mutation: CREATE_DONATION_MUTATION,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, createDonation => __jsx(StripeCheckout, {\n        amount: this.state.gift * 100,\n        email: this.state.email,\n        name: \"Free Spirits\",\n        description: `Donate to save wild cats`,\n        image: image,\n        stripeKey: \"pk_test_KiZyYKiQtlmrqhtoGEbkdtuR00es4lCEgx\",\n        currency: \"AUD\",\n        token: res => this.onToken(res, createDonation),\n        bitcoin: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, __jsx(Button, {\n        height: 50,\n        marginTop: 30,\n        appearance: \"primary\",\n        intent: \"success\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, \"Complete this Transaction\")))));\n    });\n  }\n\n}\n\nexport default DonationForm;\nexport { ALL_CATS_QUERY };","map":{"version":3,"sources":["/Users/jinz/Projects/project3/frontend/components/DonationForm.js"],"names":["React","Component","Router","gql","FormField","TextInputField","Autocomplete","TextInput","Checkbox","Button","Heading","Combobox","styled","StripeCheckout","Query","Mutation","_","Styles","div","ALL_CATS_QUERY","CREATE_DONATION_MUTATION","DonationForm","email","updates","gift","props","amount","allocation","e","setState","target","name","value","res","createDonation","donation","variables","Number","state","stripetoken","id","cat","then","push","pathname","catch","err","alert","message","render","data","catsName","pluck","allCats","where","image","changedItem","toString","getInputProps","getRef","inputValue","openMenu","onFocus","selected","display","alignItems","update","checked","onToken"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Router from \"next/router\";\nimport gql from \"graphql-tag\";\nimport {\n  FormField,\n  TextInputField,\n  Autocomplete,\n  TextInput,\n  Checkbox,\n  Button,\n  Heading,\n  Combobox\n} from \"evergreen-ui\";\nimport styled from \"styled-components\";\nimport StripeCheckout from \"react-stripe-checkout\";\nimport { Query, Mutation } from \"react-apollo\";\nimport _ from \"underscore\";\n\nconst Styles = styled.div`\n  background-color: white;\n  padding: 2rem 5rem;\n`;\n\nconst ALL_CATS_QUERY = gql`\n  query ALL_CATS_QUERY {\n    allCats {\n      id\n      name\n      image\n      iucnStatus\n    }\n  }\n`;\n\nconst CREATE_DONATION_MUTATION = gql`\n  mutation CREATE_DONATION_MUTATION(\n    $amount: Integer!\n    $email: String!\n    $stripetoken: String!\n    $cat: String!\n  ) {\n    createDonation(\n      input: {\n        amount: $amount\n        email: $email\n        stripetoken: $stripetoken\n        cat: $cat\n      }\n    ) {\n      ok\n      donation {\n        id\n      }\n    }\n  }\n`;\n\nclass DonationForm extends Component {\n  state = {\n    email: \"\",\n    updates: false,\n    gift: this.props.amount || 20,\n    allocation: \"\"\n  };\n\n  saveToState = e => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n\n  onToken = async (res, createDonation) => {\n    const donation = await createDonation({\n      variables: {\n        amount: Number(this.state.gift),\n        stripetoken: res.id,\n        email: res.email,\n        cat: this.state.allocation\n      }\n    })\n      .then(res => {\n        Router.push({\n          pathname: \"/thankyou\"\n        });\n      })\n      .catch(err => {\n        alert(err.message);\n      });\n  };\n\n  render() {\n    return (\n      <Query query={ALL_CATS_QUERY}>\n        {({ data }) => {\n          const catsName = _.pluck(data.allCats, \"name\");\n          let cat = _.where(data.allCats, { name: this.state.allocation })[0];\n          let image = cat ? cat.image : \"/image/stripe.jpg\";\n          return (\n            <Styles>\n              <FormField label=\"\">\n                <Heading size={500} marginTop=\"default\">\n                  Email\n                </Heading>\n                <TextInput\n                  placeholder=\"Enter your email\"\n                  width={400}\n                  value={this.state.email}\n                  label=\"email\"\n                  onChange={e => this.setState({ email: e.target.value })}\n                />\n                <Heading size={500} marginTop=\"default\">\n                  Gift Amount *\n                </Heading>\n\n                <Autocomplete\n                  height={50}\n                  items={[25.0, 50.0, 100.0, 200.0, 500.0]}\n                  onChange={changedItem => this.setState({ gift: changedItem })}\n                  initialInputValue={this.state.gift.toString()}\n                >\n                  {props => {\n                    const {\n                      getInputProps,\n                      getRef,\n                      inputValue,\n                      openMenu\n                    } = props;\n                    return (\n                      <TextInput\n                        placeholder=\"Choose or Enter an Amount\"\n                        width={400}\n                        value={inputValue}\n                        innerRef={getRef}\n                        label=\"Gift Amount\"\n                        {...getInputProps({\n                          onFocus: () => {\n                            openMenu();\n                          }\n                        })}\n                      />\n                    );\n                  }}\n                </Autocomplete>\n                <Heading size={500} marginTop=\"default\">\n                  Allocation\n                </Heading>\n                <Combobox\n                  name=\"allocation\"\n                  openOnFocus\n                  width={400}\n                  items={[...catsName, \"All Cats\"]}\n                  onChange={selected => this.setState({ allocation: selected })}\n                  placeholder=\"Select a Cat\"\n                />\n                <div style={{ display: \"flex\", alignItems: \"center\" }}>\n                  <Checkbox\n                    name=\"updates\"\n                    checked={this.state.update}\n                    onChange={e => this.setState({ update: e.target.checked })}\n                  />\n                  <Heading size={500} marginTop={0} marginLeft={10}>\n                    Keep me updated on Free Spirits news\n                  </Heading>\n                </div>\n                <Mutation mutation={CREATE_DONATION_MUTATION}>\n                  {createDonation => (\n                    <StripeCheckout\n                      amount={this.state.gift * 100}\n                      email={this.state.email}\n                      name=\"Free Spirits\"\n                      description={`Donate to save wild cats`}\n                      image={image}\n                      stripeKey=\"pk_test_KiZyYKiQtlmrqhtoGEbkdtuR00es4lCEgx\"\n                      currency=\"AUD\"\n                      token={res => this.onToken(res, createDonation)}\n                      bitcoin={true}\n                    >\n                      <Button\n                        height={50}\n                        marginTop={30}\n                        appearance=\"primary\"\n                        intent=\"success\"\n                      >\n                        Complete this Transaction\n                      </Button>\n                    </StripeCheckout>\n                  )}\n                </Mutation>\n              </FormField>\n            </Styles>\n          );\n        }}\n      </Query>\n    );\n  }\n}\n\nexport default DonationForm;\nexport { ALL_CATS_QUERY };\n"]},"metadata":{},"sourceType":"module"}